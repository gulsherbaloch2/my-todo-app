# Data Model: Todo Application Backend

## Entity: Task

### Fields
- **id** (Integer, Primary Key, Auto-increment)
  - Unique identifier for each task
  - Auto-generated by the database
  
- **user_id** (String, Indexed)
  - Identifier of the user who owns the task
  - Comes from JWT token verification
  - Indexed for efficient querying by user
  
- **title** (String, Required, Length: 1-200 characters)
  - Title of the task
  - Required field with length validation
  
- **description** (Text, Optional)
  - Detailed description of the task
  - Optional field that can be null
  
- **completed** (Boolean, Default: False)
  - Completion status of the task
  - Boolean flag indicating if the task is completed
  
- **created_at** (DateTime, Auto-generated)
  - Timestamp when the task was created
  - Automatically set when record is inserted
  
- **updated_at** (DateTime, Auto-generated)
  - Timestamp when the task was last updated
  - Automatically updated when record is modified

### Relationships
- **Belongs to**: User (identified by user_id from JWT)

### Validation Rules
- Title must be between 1 and 200 characters
- user_id must match the authenticated user's ID from JWT
- Only the owner can modify/delete the task

### Indexes
- Index on user_id for efficient retrieval of user-specific tasks
- Index on completed for potential filtering/grouping operations

## Entity: User (Conceptual)

### Fields
- **user_id** (String, From JWT)
  - Unique identifier extracted from JWT token
  - Used to establish ownership of tasks
  - Not stored in our database (managed by Better Auth)

### Relationships
- **Has many**: Tasks (linked via user_id foreign key)

## State Transitions

### Task State Transitions
- **Incomplete → Complete**: When PATCH /api/{user_id}/tasks/{id}/complete is called with completed=true
- **Complete → Incomplete**: When PATCH /api/{user_id}/tasks/{id}/complete is called with completed=false

## Constraints
- Referential integrity: All tasks must belong to a valid user (verified via JWT)
- Access control: Users can only access tasks with matching user_id
- Data validation: All input must pass Pydantic validation before persistence